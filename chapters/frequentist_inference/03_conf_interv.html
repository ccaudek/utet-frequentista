<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="it" xml:lang="it"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.34">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4&nbsp; Intervalli di fiducia – Inferenza frequentista in psicologia — Modulo introduttivo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../chapters/frequentist_inference/04_sample_size.html" rel="next">
<link href="../../chapters/frequentist_inference/02_stime_parametri.html" rel="prev">
<link href="../../style/gauss.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0a72236910a44089af39cd28873f322e.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-9908c7b05874059c2106d454ac00f1d0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nessun risultato",
    "search-matching-documents-text": "documenti trovati",
    "search-copy-link-title": "Copiare il link nella ricerca",
    "search-hide-matches-text": "Nascondere i risultati aggiuntivi",
    "search-more-match-text": "ci sono altri risultati in questo documento",
    "search-more-matches-text": "ulteriori risultati in questo documento",
    "search-clear-button-title": "Pulire",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancellare",
    "search-submit-button-title": "Inviare",
    "search-label": "Ricerca"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QT5S3P9D31"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QT5S3P9D31', { 'anonymize_ip': true});
</script><style>html{ scroll-behavior: smooth; }</style>
<script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
</script><script>
window.MathJax = {
  tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
  svg: { scale: 1, mtextInheritFont: true, fontCache: 'none', minScale: 1 },
  options: { renderActions: { addMenu: [0, '', ''] } },
  loader: { load: ['input/tex','output/svg'] }
};
// Suggerimento CSS: vedi sezione 3 per gli spazi attorno a display math
</script><script>
window.MathJax = {
  tex: {
    packages: {'[+]': ['boldsymbol']},
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  },
  svg: { fontCache: 'global' }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="../../style/_typography-extras.css">
<link rel="stylesheet" href="../../style/_code-extras.css">
<link rel="stylesheet" href="../../style/_math-extras.css">
<link rel="stylesheet" href="../../style/styles.css">
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html">Frequentismo</a></li><li class="breadcrumb-item"><a href="../../chapters/frequentist_inference/03_conf_interv.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Attiva/disattiva la barra laterale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Ricerca" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../../">Inferenza frequentista in psicologia — Modulo introduttivo</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ccaudek/utet-frequentista/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Attiva/disattiva la modalità lettore">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Ricerca"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Percorso e obiettivi</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../prefazione.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Prefazione</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Frequentismo</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduzione</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/01_galton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Inferenza frequentista</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/02_stime_parametri.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/03_conf_interv.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/04_sample_size.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/05_test_ipotesi.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Significatività statistica</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/frequentist_inference/06_two_ind_samples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Test t di Student per campioni indipendenti</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Epilogo</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Attiva/disattiva sezione">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../chapters/epiloque/epiloque.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Considerazioni Conclusive</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Sommario</h2>
   
  <ul class="collapse">
<li><a href="#introduzione" id="toc-introduzione" class="nav-link active" data-scroll-target="#introduzione"><span class="header-section-number">4.1</span> Introduzione</a></li>
  <li><a href="#inferenza-statistica-frequentista-e-media-campionaria" id="toc-inferenza-statistica-frequentista-e-media-campionaria" class="nav-link" data-scroll-target="#inferenza-statistica-frequentista-e-media-campionaria"><span class="header-section-number">4.2</span> Inferenza Statistica Frequentista e Media Campionaria</a></li>
  <li><a href="#intervallo-di-confidenza-per-la-media-caso-di-varianza-nota" id="toc-intervallo-di-confidenza-per-la-media-caso-di-varianza-nota" class="nav-link" data-scroll-target="#intervallo-di-confidenza-per-la-media-caso-di-varianza-nota"><span class="header-section-number">4.3</span> Intervallo di Confidenza per la Media: Caso di Varianza Nota</a></li>
  <li><a href="#intervallo-di-confidenza-per-la-media-caso-di-varianza-incognita" id="toc-intervallo-di-confidenza-per-la-media-caso-di-varianza-incognita" class="nav-link" data-scroll-target="#intervallo-di-confidenza-per-la-media-caso-di-varianza-incognita"><span class="header-section-number">4.4</span> Intervallo di Confidenza per la Media: Caso di Varianza Incognita</a></li>
  <li><a href="#livello-di-copertura" id="toc-livello-di-copertura" class="nav-link" data-scroll-target="#livello-di-copertura"><span class="header-section-number">4.5</span> Livello di Copertura</a></li>
  <li><a href="#il-concetto-di-livello-di-confidenza" id="toc-il-concetto-di-livello-di-confidenza" class="nav-link" data-scroll-target="#il-concetto-di-livello-di-confidenza"><span class="header-section-number">4.6</span> Il Concetto di Livello di Confidenza</a></li>
  <li><a href="#confronto-tra-intervalli-frequentisti-e-bayesiani" id="toc-confronto-tra-intervalli-frequentisti-e-bayesiani" class="nav-link" data-scroll-target="#confronto-tra-intervalli-frequentisti-e-bayesiani"><span class="header-section-number">4.7</span> Confronto tra Intervalli Frequentisti e Bayesiani</a></li>
  <li><a href="#riflessioni-conclusive" id="toc-riflessioni-conclusive" class="nav-link" data-scroll-target="#riflessioni-conclusive"><span class="header-section-number">4.8</span> Riflessioni Conclusive</a></li>
  <li><a href="#esercizi" id="toc-esercizi" class="nav-link" data-scroll-target="#esercizi">Esercizi</a></li>
  <li><a href="#informazioni-sullambiente-di-sviluppo" id="toc-informazioni-sullambiente-di-sviluppo" class="nav-link" data-scroll-target="#informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</a></li>
  <li><a href="#bibliografia" id="toc-bibliografia" class="nav-link" data-scroll-target="#bibliografia">Bibliografia</a></li>
  </ul><div class="toc-actions"><ul class="collapse"><li><a href="https://github.com/ccaudek/utet-frequentista/blob/main/chapters/frequentist_inference/03_conf_interv.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-frequentista/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../chapters/frequentist_inference/introduction_frequentist_inference.html">Frequentismo</a></li><li class="breadcrumb-item"><a href="../../chapters/frequentist_inference/03_conf_interv.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-frequentism-confidence-intervals" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Intervalli di fiducia</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><div class="callout callout-style-simple callout-important no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
In questo capitolo imparerai a
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>sapere calcolare e interpretare gli intervalli di fiducia frequentisti.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Prerequisiti
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Leggere il capitolo <em>Estimation, Confidence Intervals, and Bootstrapping</em> di <a href="https://moderndive.com/v2/">Statistical Inference via Data Science: A ModernDive into R and the Tidyverse (Second Edition)</a>.</li>
<li>Leggere il capitolo <em>Sampling Distributions of Estimators</em> <span class="citation" data-cites="schervish2014probability">(<a href="#ref-schervish2014probability" role="doc-biblioref">Schervish &amp; DeGroot, 2014</a>)</span>.</li>
</ul>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Preparazione del Notebook
</div>
</div>
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html">here</a></span><span class="op">(</span><span class="st">"code"</span>, <span class="st">"_common.R"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load packages</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"pacman"</span><span class="op">)</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">cmdstanr</span>, <span class="va">posterior</span>, <span class="va">bayestestR</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="introduzione" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="introduzione">
<span class="header-section-number">4.1</span> Introduzione</h2>
<p>Gli intervalli di confidenza sono uno strumento fondamentale nell’inferenza statistica frequentista. Essi consentono di stimare un parametro sconosciuto di una popolazione, come la media <span class="math inline">\(\mu\)</span>, tenendo conto dell’incertezza derivante dal fatto che la stima si basa su un campione. Questo materiale didattico si propone di spiegare in modo dettagliato e chiaro la costruzione di un intervallo di confidenza per la media di una popolazione, sia nel caso di varianza nota sia in quello di varianza incognita.</p>
</section><section id="inferenza-statistica-frequentista-e-media-campionaria" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="inferenza-statistica-frequentista-e-media-campionaria">
<span class="header-section-number">4.2</span> Inferenza Statistica Frequentista e Media Campionaria</h2>
<p>Quando estraiamo un campione casuale semplice <span class="math inline">\(X_1, X_2, \dots, X_n\)</span> da una popolazione con media <span class="math inline">\(\mu\)</span> e varianza <span class="math inline">\(\sigma^2\)</span>, la media campionaria <span class="math inline">\(\bar{X}\)</span> è definita come:</p>
<p><span class="math display">\[
\bar{X} = \frac{1}{n} \sum_{i=1}^n X_i.
\]</span></p>
<p>La media campionaria <span class="math inline">\(\bar{X}\)</span> è una <strong>variabile casuale</strong> perché dipende dai valori osservati nel campione, che sono essi stessi casuali. Le proprietà della media campionaria sono le seguenti:</p>
<ul>
<li>
<strong>Media della distribuzione campionaria</strong>: <span class="math inline">\(E[\bar{X}] = \mu\)</span>. La media campionaria è uno stimatore non distorto della media della popolazione.</li>
<li>
<strong>Varianza della distribuzione campionaria</strong>: <span class="math inline">\(\text{Var}(\bar{X}) = \frac{\sigma^2}{n}\)</span>. Questo significa che la precisione di <span class="math inline">\(\bar{X}\)</span> come stima di <span class="math inline">\(\mu\)</span> aumenta con il numero di osservazioni <span class="math inline">\(n\)</span>.</li>
</ul>
<p>Queste proprietà sono fondamentali per calcolare un intervallo di confidenza, poiché ci permettono di descrivere la distribuzione di <span class="math inline">\(\bar{X}\)</span>.</p>
</section><section id="intervallo-di-confidenza-per-la-media-caso-di-varianza-nota" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="intervallo-di-confidenza-per-la-media-caso-di-varianza-nota">
<span class="header-section-number">4.3</span> Intervallo di Confidenza per la Media: Caso di Varianza Nota</h2>
<p>Supponiamo che la popolazione sia distribuita normalmente con media <span class="math inline">\(\mu\)</span> e varianza <span class="math inline">\(\sigma^2\)</span>, e che <span class="math inline">\(\sigma^2\)</span> sia nota. La distribuzione della media campionaria <span class="math inline">\(\bar{X}\)</span> è anch’essa normale:</p>
<p><span class="math display">\[
\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right).
\]</span></p>
<p><strong>Passo 1: Standardizzazione della Media Campionaria.</strong></p>
<p>Per lavorare con una distribuzione normale standard (media 0 e varianza 1), standardizziamo <span class="math inline">\(\bar{X}\)</span> utilizzando la formula:</p>
<p><span class="math display">\[
Z = \frac{\bar{X} - \mu}{\sigma / \sqrt{n}}.
\]</span></p>
<p>Qui, <span class="math inline">\(\sigma / \sqrt{n}\)</span> è la <strong>deviazione standard</strong> della distribuzione campionaria di <span class="math inline">\(\bar{X}\)</span>.</p>
<p>Dopo questa trasformazione, la variabile <span class="math inline">\(Z\)</span> segue una distribuzione normale standard:</p>
<p><span class="math display">\[
Z \sim \mathcal{N}(0, 1).
\]</span></p>
<p><strong>Passo 2: Determinazione del Livello di Confidenza.</strong></p>
<p>Scegliamo un livello di confidenza <span class="math inline">\(\gamma\)</span>, ad esempio <span class="math inline">\(\gamma = 0.95\)</span>. Per una distribuzione normale standard, troviamo il valore critico <span class="math inline">\(z\)</span> tale che la probabilità tra <span class="math inline">\(-z\)</span> e <span class="math inline">\(+z\)</span> sia pari al livello di confidenza:</p>
<p><span class="math display">\[
P(-z \leq Z \leq z) = \gamma.
\]</span></p>
<p>Per un livello di confidenza del 95%, <span class="math inline">\(z \approx 1.96\)</span>.</p>
<p><strong>Passo 3: Formulazione dell’Intervallo di Confidenza.</strong></p>
<p>Partiamo dalla probabilità per <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display">\[
P(-z \leq Z \leq z) = \gamma.
\]</span></p>
<p>Sostituiamo la definizione di <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display">\[
P\left(-z \leq \frac{\bar{X} - \mu}{\sigma / \sqrt{n}} \leq z\right) = \gamma.
\]</span></p>
<p>Moltiplichiamo tutti i membri per <span class="math inline">\(\sigma / \sqrt{n}\)</span> per rimuovere il denominatore:</p>
<p><span class="math display">\[
P\left(-z \cdot \frac{\sigma}{\sqrt{n}} \leq \bar{X} - \mu \leq z \cdot \frac{\sigma}{\sqrt{n}}\right) = \gamma.
\]</span></p>
<p>Aggiungiamo <span class="math inline">\(\mu\)</span> a tutti i membri per isolare <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
P\left(\bar{X} - z \cdot \frac{\sigma}{\sqrt{n}} \leq \mu \leq \bar{X} + z \cdot \frac{\sigma}{\sqrt{n}}\right) = \gamma.
\]</span></p>
<p><strong>Passo 4: Limiti dell’Intervallo di Confidenza.</strong></p>
<p>Definiamo i limiti inferiore e superiore dell’intervallo di confidenza:</p>
<p><span class="math display">\[
\hat{a} = \bar{X} - z \cdot \frac{\sigma}{\sqrt{n}}, \quad \hat{b} = \bar{X} + z \cdot \frac{\sigma}{\sqrt{n}}.
\]</span></p>
<p>L’intervallo di confidenza per <span class="math inline">\(\mu\)</span> è quindi:</p>
<p><span class="math display">\[
(\hat{a}, \hat{b}) = \left(\bar{X} - z \cdot \frac{\sigma}{\sqrt{n}}, \bar{X} + z \cdot \frac{\sigma}{\sqrt{n}}\right).
\]</span></p>
</section><section id="intervallo-di-confidenza-per-la-media-caso-di-varianza-incognita" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="intervallo-di-confidenza-per-la-media-caso-di-varianza-incognita">
<span class="header-section-number">4.4</span> Intervallo di Confidenza per la Media: Caso di Varianza Incognita</h2>
<p>Nella maggior parte dei casi pratici, la varianza <span class="math inline">\(\sigma^2\)</span> non è nota. In questi casi, stimiamo <span class="math inline">\(\sigma\)</span> con la deviazione standard campionaria <span class="math inline">\(s\)</span> e utilizziamo la distribuzione t di Student, che tiene conto dell’incertezza aggiuntiva.</p>
<p><strong>Passo 1: Distribuzione t di Student.</strong></p>
<p>La statistica che seguiamo è:</p>
<p><span class="math display">\[
T = \frac{\bar{X} - \mu}{s / \sqrt{n}},
\]</span></p>
<p>dove <span class="math inline">\(T\)</span> segue una distribuzione t con <span class="math inline">\(n-1\)</span> gradi di libertà.</p>
<p><strong>Passo 2: Costruzione dell’Intervallo di Confidenza.</strong></p>
<p>Analogamente al caso precedente, costruiamo l’intervallo partendo da:</p>
<p><span class="math display">\[
P(-t^\ast \leq T \leq t^\ast) = \gamma,
\]</span></p>
<p>dove <span class="math inline">\(t^\ast\)</span> è il valore critico della distribuzione t per il livello di confidenza <span class="math inline">\(\gamma\)</span> e <span class="math inline">\(n-1\)</span> gradi di libertà.</p>
<p>Sostituendo <span class="math inline">\(T\)</span>:</p>
<p><span class="math display">\[
P\left(-t^\ast \leq \frac{\bar{X} - \mu}{s / \sqrt{n}} \leq t^\ast\right) = \gamma.
\]</span></p>
<p>Moltiplichiamo per <span class="math inline">\(s / \sqrt{n}\)</span>:</p>
<p><span class="math display">\[
P\left(-t^\ast \cdot \frac{s}{\sqrt{n}} \leq \bar{X} - \mu \leq t^\ast \cdot \frac{s}{\sqrt{n}}\right) = \gamma.
\]</span></p>
<p>Aggiungiamo <span class="math inline">\(\mu\)</span>:</p>
<p><span class="math display">\[
P\left(\bar{X} - t^\ast \cdot \frac{s}{\sqrt{n}} \leq \mu \leq \bar{X} + t^\ast \cdot \frac{s}{\sqrt{n}}\right) = \gamma.
\]</span></p>
<p><strong>Passo 3: Limiti dell’Intervallo.</strong></p>
<p>I limiti dell’intervallo sono:</p>
<p><span class="math display">\[
\hat{a} = \bar{X} - t^\ast \cdot \frac{s}{\sqrt{n}}, \quad \hat{b} = \bar{X} + t^\ast \cdot \frac{s}{\sqrt{n}}.
\]</span></p>
<p>In conclusione, gli intervalli di confidenza forniscono un modo per quantificare l’incertezza nelle stime di parametri sconosciuti. La loro costruzione dipende dalla distribuzione campionaria dello stimatore e dall’informazione disponibile sulla varianza.</p>
<section id="applicabilità-e-limitazioni" class="level3" data-number="4.4.1"><h3 data-number="4.4.1" class="anchored" data-anchor-id="applicabilità-e-limitazioni">
<span class="header-section-number">4.4.1</span> Applicabilità e Limitazioni</h3>
<ul>
<li>Il metodo presuppone che la popolazione segua una distribuzione normale e è valido anche per campioni di piccole dimensioni (ad esempio, <span class="math inline">\(n &lt; 30\)</span>) prelevati da tale popolazione.</li>
<li>Se la popolazione non è normalmente distribuita e la dimensione del campione è ridotta, questo metodo potrebbe non essere idoneo.</li>
<li>Tuttavia, per campioni di grandi dimensioni (<span class="math inline">\(n \geq 30\)</span>), questo approccio rimane valido per la stima dell’intervallo di confidenza grazie al teorema del limite centrale, che si applica anche a popolazioni con distribuzioni non normali.</li>
</ul></section></section><section id="livello-di-copertura" class="level2" data-number="4.5"><h2 data-number="4.5" class="anchored" data-anchor-id="livello-di-copertura">
<span class="header-section-number">4.5</span> Livello di Copertura</h2>
<p>Per interpretare correttamente gli intervalli di fiducia è fondamentale considerare il concetto di “livello di copertura”. Questo livello indica la frequenza con cui l’intervallo di fiducia include il valore reale del parametro della popolazione, in una serie di esperimenti ripetuti.</p>
<p>Esempio di Livello di Copertura:</p>
<ul>
<li>Se il livello di copertura è del 95%, significa che, nel lungo periodo, il 95% degli intervalli di fiducia costruiti conterrà il valore vero del parametro.</li>
<li>Importante: Questo non implica che ci sia una probabilità del 95% che il valore vero del parametro cada in un particolare intervallo di fiducia. Infatti, il parametro della popolazione è un valore fisso e non soggetto a probabilità; piuttosto, l’incertezza risiede nell’intervallo di fiducia stesso.</li>
</ul>
<p>Come Funziona la Copertura:</p>
<ul>
<li>Nel contesto frequentista, la “probabilità” si riferisce alla frequenza a lungo termine di un certo evento in un gran numero di ripetizioni dell’esperimento.</li>
<li>Nel caso degli intervalli di fiducia, l’“esperimento” è l’estrazione di un campione dalla popolazione, e l’“evento” è la generazione di un intervallo di fiducia che contiene il valore vero del parametro.</li>
<li>Il livello di copertura, generalmente indicato come <span class="math inline">\(1-\alpha\)</span>, rappresenta la probabilità a lungo termine che intervalli di fiducia costruiti con questa metodologia includano il vero valore del parametro.</li>
</ul>
<section id="simulazione" class="level3" data-number="4.5.1"><h3 data-number="4.5.1" class="anchored" data-anchor-id="simulazione">
<span class="header-section-number">4.5.1</span> Simulazione</h3>
<ul>
<li>Per illustrare questo concetto, eseguiamo una simulazione con la popolazione degli adulti maschi italiani, assunta come normalmente distribuita con media 175 cm e varianza 49 cm².</li>
<li>Eseguiamo 1000 ripetizioni di un esperimento, estraendo ogni volta un campione di 30 individui.</li>
<li>Per ciascun campione, calcoliamo l’intervallo di fiducia al 95% usando la formula:</li>
</ul>
<p><span class="math display">\[
\bar{X} \pm t \frac{s}{\sqrt{n}},
\]</span></p>
<p>dove <span class="math inline">\(\bar{X}\)</span> è la media campionaria, <span class="math inline">\(s\)</span> è la deviazione standard campionaria e <span class="math inline">\(t\)</span> è il valore critico della distribuzione t-Student per <span class="math inline">\(n-1\)</span> gradi di libertà al livello di significatività <span class="math inline">\(\alpha/2 = 0.025\)</span>. - Registriamo i limiti di ciascun intervallo e controlliamo quanti di essi includono effettivamente il vero valore medio della popolazione.</p>
<p>Attraverso questa simulazione, possiamo visualizzare concretamente il concetto di livello di copertura e la sua importanza nella statistica frequentista.</p>
<p>In questa simulazione, genereremo 1000 campioni casuali di dimensione <span class="math inline">\(n = 30\)</span> da una distribuzione normale con media <span class="math inline">\(\mu = 175\)</span> e deviazione standard <span class="math inline">\(\sigma = 7\)</span>. Successivamente, calcoleremo gli intervalli di confidenza al 95% per ciascun campione e valuteremo il livello di copertura.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># Per riproducibilità</span></span>
<span></span>
<span><span class="co"># Parametri della distribuzione</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">175</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">7</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">n_samples</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Generazione dei campioni</span></span>
<span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">replicate</a></span><span class="op">(</span><span class="va">n_samples</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span>  <span class="co"># Verifica dimensioni: 30 righe per 1000 colonne</span></span>
<span><span class="co">#&gt; [1]   30 1000</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Il primo campione di ampiezza <span class="math inline">\(n = 30\)</span> che abbiamo ottenuto è il seguente:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">samples</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>  <span class="co"># Primo campione</span></span>
<span><span class="co">#&gt;  [1] 171 173 186 175 176 187 178 166 170 172 184 178 178 176 171 188 178 161 180</span></span>
<span><span class="co">#&gt; [20] 172 168 173 168 170 171 163 181 176 167 184</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Stampiamo le medie dei primi dieci campioni:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">colMeans</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span>  <span class="co"># Medie di tutti i campioni</span></span>
<span><span class="va">sample_means</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>  <span class="co"># Prime dieci medie</span></span>
<span><span class="co">#&gt;  [1] 175 176 175 174 174 176 175 174 175 177</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Troviamo il valore critico della distribuzione <span class="math inline">\(t\)</span> di Student con <span class="math inline">\(n - 1\)</span> gradi di libertà e livello di confidenza del 95% (<span class="math inline">\(\alpha = 0.05\)</span>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">t_critical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># Valore critico</span></span>
<span><span class="va">t_critical</span></span>
<span><span class="co">#&gt; [1] 2.05</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Utilizzando il valore critico <span class="math inline">\(t\)</span>, calcoliamo 1000 intervalli di confidenza per la media della popolazione:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calcolo della deviazione standard campionaria</span></span>
<span><span class="va">sample_sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">samples</span>, <span class="fl">2</span>, <span class="va">sd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Ampiezza degli intervalli</span></span>
<span><span class="va">interval_width</span> <span class="op">&lt;-</span> <span class="va">t_critical</span> <span class="op">*</span> <span class="va">sample_sds</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Limiti degli intervalli di confidenza</span></span>
<span><span class="va">CI_low</span> <span class="op">&lt;-</span> <span class="va">sample_means</span> <span class="op">-</span> <span class="va">interval_width</span></span>
<span><span class="va">CI_high</span> <span class="op">&lt;-</span> <span class="va">sample_means</span> <span class="op">+</span> <span class="va">interval_width</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Troviamo il livello di copertura, ovvero la proporzione di intervalli di confidenza che contengono il vero valore della media della popolazione <span class="math inline">\(\mu\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">CI_low</span> <span class="op">&lt;</span> <span class="va">mu</span> <span class="op">&amp;</span> <span class="va">mu</span> <span class="op">&lt;</span> <span class="va">CI_high</span><span class="op">)</span>  <span class="co"># Proporzione di copertura</span></span>
<span><span class="va">coverage</span></span>
<span><span class="co">#&gt; [1] 0.956</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In conclusione, ripetendo la simulazione per 1000 campioni, abbiamo ottenuto un livello di copertura molto vicino al valore nominale di <span class="math inline">\(1 - \alpha = 0.95\)</span>. Questo risultato dimostra che, con un campione di dimensione <span class="math inline">\(n = 30\)</span>, gli intervalli di confidenza al 95% calcolati utilizzando la distribuzione <span class="math inline">\(t\)</span> di Student forniscono stime accurate della media della popolazione.</p>
</section></section><section id="il-concetto-di-livello-di-confidenza" class="level2" data-number="4.6"><h2 data-number="4.6" class="anchored" data-anchor-id="il-concetto-di-livello-di-confidenza">
<span class="header-section-number">4.6</span> Il Concetto di Livello di Confidenza</h2>
<p>Gli intervalli di confidenza sono range di valori che, con una certa sicurezza statistica, si ritiene includano il parametro di interesse.</p>
<p>Secondo l’approccio frequentista, l’intervallo di confidenza si deve considerare come una metodologia:</p>
<ul>
<li>Se ripetiamo l’esperimento (estrarre un campione e calcolare l’intervallo di confidenza) molte volte, il metodo produce un intervallo che coprirà il valore vero del parametro nel 95% dei casi, assumendo un livello di confidenza del 95%.</li>
</ul>
<section id="un-malinteso-comune-nellinterpretazione-degli-intervalli-di-confidenza" class="level3" data-number="4.6.1"><h3 data-number="4.6.1" class="anchored" data-anchor-id="un-malinteso-comune-nellinterpretazione-degli-intervalli-di-confidenza">
<span class="header-section-number">4.6.1</span> Un Malinteso Comune nell’Interpretazione degli Intervalli di Confidenza</h3>
<p>È inesatto affermare che un determinato intervallo di confidenza contenga il valore vero di un parametro con una probabilità del 95%. Questo è un errore diffuso, persino tra i ricercatori, che spesso interpretano l’intervallo di confidenza come indicativo della probabilità che il parametro (ad esempio, la media della popolazione <span class="math inline">\(\mu\)</span>) si trovi effettivamente all’interno di un dato intervallo (es. <span class="math inline">\([\hat{a}, \hat{b}]\)</span>).</p>
<p>La descrizione corretta è la seguente:</p>
<ul>
<li>“La metodologia impiegata per calcolare l’intervallo <span class="math inline">\([\hat{a}, \hat{b}]\)</span> ha il 95% di probabilità di generare un intervallo che include il vero valore del parametro”.</li>
<li>Ciò significa che l’intervallo di confidenza non esprime una probabilità circa la posizione precisa del parametro, ma riflette la probabilità che la procedura adottata per determinarlo generi un intervallo che lo includa.</li>
</ul>
<p>In conclusione, l’intervallo di confidenza ci fornisce una garanzia statistica riguardo alla affidabilità del metodo usato per la sua stima, piuttosto che sulla esatta ubicazione del parametro in questione.</p>
</section><section id="fraintendimenti-comuni-sugli-intervalli-di-confidenza" class="level3" data-number="4.6.2"><h3 data-number="4.6.2" class="anchored" data-anchor-id="fraintendimenti-comuni-sugli-intervalli-di-confidenza">
<span class="header-section-number">4.6.2</span> Fraintendimenti Comuni sugli Intervalli di Confidenza</h3>
<p>Nel loro lavoro, <span class="citation" data-cites="hoekstra2014robust">Hoekstra et al. (<a href="#ref-hoekstra2014robust" role="doc-biblioref">2014</a>)</span> evidenziano come, nonostante l’ampio riconoscimento dei limiti dei test di ipotesi nulle, gli intervalli di confidenza siano spesso consigliati per l’inferenza statistica. Anche l’American Psychological Association (APA) suggerisce che gli intervalli di confidenza siano “in generale, la migliore strategia di reportistica”. Tuttavia, <span class="citation" data-cites="hoekstra2014robust">Hoekstra et al. (<a href="#ref-hoekstra2014robust" role="doc-biblioref">2014</a>)</span> sottolineano che queste raccomandazioni non considerano la difficoltà nel fornire una corretta interpretazione degli intervalli di confidenza.</p>
<p>Per indagare l’interpretazione degli intervalli di confidenza, <span class="citation" data-cites="hoekstra2014robust">Hoekstra et al. (<a href="#ref-hoekstra2014robust" role="doc-biblioref">2014</a>)</span> hanno condotto uno studio con due domande principali:</p>
<ol type="1">
<li>Quanto frequentemente intervalli di confidenza sono mal interpretati da studenti e ricercatori?</li>
<li>L’esperienza nella ricerca riduce le interpretazioni errate degli intervalli di confidenza?</li>
</ol>
<p>Prima di presentare lo studio, <span class="citation" data-cites="hoekstra2014robust">Hoekstra et al. (<a href="#ref-hoekstra2014robust" role="doc-biblioref">2014</a>)</span> ricordano qual è l’interpretazione corretta degli intervalli di confidenza.</p>
<blockquote class="blockquote">
<p>A CI is a numerical interval constructed around the estimate of a parameter. Such an interval does not, however, directly indicate a property of the parameter; instead, it indicates a property of the procedure, as is typical for a frequentist technique. Specifically, we may find that a particular procedure, when used repeatedly across a series of hypothetical data sets (i.e., the sample space), yields intervals that contain the true parameter value in 95% of the cases. When such a procedure is applied to a particular data set, the resulting interval is said to be a 95% CI. The key point is that the CIs do not provide for a statement about the parameter as it relates to the particular sample at hand; instead, they provide for a statement about the performance of the procedure of drawing such intervals in repeated use. Hence, it is incorrect to interpret a CI as the probability that the true value is within the interval (e.g., Berger &amp; Wolpert, 1988). As is the case with <span class="math inline">\(p\)</span>-values, CIs do not allow one to make probability statements about parameters or hypotheses.</p>
</blockquote>
<p>Nel loro studio, <span class="citation" data-cites="hoekstra2014robust">Hoekstra et al. (<a href="#ref-hoekstra2014robust" role="doc-biblioref">2014</a>)</span> hanno presentato un questionario a 596 partecipanti, tra cui studenti universitari e ricercatori, con le seguenti affermazioni riguardanti l’interpretazione degli intervalli di confidenza.</p>
<blockquote class="blockquote">
<p>Professor Bumbledorf conducts an experiment, analyzes the data, and reports: “The 95% confidence interval for the mean ranges from 0.1 to 0.4.” Please mark each of the statements below as ‘true’ or ‘false’.</p>
</blockquote>
<blockquote class="blockquote">
<ol type="1">
<li>The probability that the true mean is greater than 0 is at least 95%.</li>
<li>The probability that the true mean equals 0 is smaller than 5%.</li>
<li>The “null hypothesis” that the true mean equals 0 is likely to be incorrect.</li>
<li>There is a 95% probability that the true mean lies between 0.1 and 0.4.</li>
<li>We can be 95% confident that the true mean lies between 0.1 and 0.4.</li>
<li>If we were to repeat the experiment over and over, then 95% of the time the true mean falls between 0.1 and 0.4.</li>
</ol>
</blockquote>
<p>Sorprendentemente, anche se tutte le sei affermazioni nel questionario sono errate, molti partecipanti hanno concordato con esse. I risultati mostrano che, in media, i partecipanti hanno concordato con circa 3.5 affermazioni errate su 6. Non è stata rilevata una differenza di rilievo nell’interpretazione degli intervalli di confidenza tra studenti e ricercatori, suggerendo che l’esperienza nella ricerca non migliora la comprensione di questo concetto.</p>
<p>I risultati indicano che molte persone interpretano erroneamente gli intervalli di confidenza, e che anche l’esperienza nella ricerca non garantisce una migliore comprensione. Questo solleva dubbi sull’efficacia degli intervalli di confidenza frequentisti e suggerisce che gli “intervalli di credibilità” bayesiani possano rappresentare un’alternativa più vantaggiosa. Quest’ultimi tendono ad essere più intuitivi e di più facile interpretazione corretta.</p>
</section></section><section id="confronto-tra-intervalli-frequentisti-e-bayesiani" class="level2" data-number="4.7"><h2 data-number="4.7" class="anchored" data-anchor-id="confronto-tra-intervalli-frequentisti-e-bayesiani">
<span class="header-section-number">4.7</span> Confronto tra Intervalli Frequentisti e Bayesiani</h2>
<p>Concludiamo questo capitolo esaminando le differenze tra l’intervallo di confidenza frequentista e l’intervallo di credibilità bayesiano, utilizzando lo stesso set di dati per entrambi i calcoli.</p>
<section id="intervallo-di-confidenza-frequentista" class="level3" data-number="4.7.1"><h3 data-number="4.7.1" class="anchored" data-anchor-id="intervallo-di-confidenza-frequentista">
<span class="header-section-number">4.7.1</span> Intervallo di confidenza frequentista</h3>
<p>Immaginiamo di avere un gruppo di 20 osservazioni relative alla performance in un test cognitivo. Il nostro obiettivo è stimare la media della popolazione da cui queste osservazioni sono tratte. Supponiamo che i dati provengano da una distribuzione normale con media <span class="math inline">\(\mu = 50\)</span> e deviazione standard <span class="math inline">\(\sigma = 10\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># Per risultati riproducibili</span></span>
<span></span>
<span><span class="co"># Parametri della popolazione</span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co"># Simulazione del campione</span></span>
<span><span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">sample_size</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 44.4 47.7 65.6 50.7 51.3 67.2 54.6 37.3 43.1 45.5 62.2 53.6 54.0 51.1 44.4</span></span>
<span><span class="co">#&gt; [16] 67.9 55.0 30.3 57.0 45.3</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizziamo la distribuzione dei dati:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>Valori <span class="op">=</span> <span class="va">sample_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Valori</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu">after_stat</span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    bins <span class="op">=</span> <span class="fl">30</span>, <span class="co"># Puoi regolare il numero di bin</span></span>
<span>    fill <span class="op">=</span> <span class="st">"skyblue"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Valori"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03_conf_interv_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<p>La <strong>media campionaria</strong> (<span class="math inline">\(\hat{\mu}\)</span>) viene calcolata come:</p>
<p><span class="math display">\[
\hat{\mu} = \frac{1}{n} \sum_{i=1}^n X_i
\]</span></p>
<p>In R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">sample_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span><span class="va">sample_mean</span></span>
<span><span class="co">#&gt; [1] 51.4</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>La <strong>deviazione standard campionaria</strong> (<span class="math inline">\(s\)</span>) si calcola come:</p>
<p><span class="math display">\[
s = \sqrt{\frac{\sum_{i=1}^n (X_i - \bar{X})^2}{n-1}}
\]</span></p>
<p>In R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">variance</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">sample_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu">variance</span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Deviazione standard campionaria</span></span>
<span><span class="va">sample_sd</span></span>
<span><span class="co">#&gt; [1] 9.48</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>L’<strong>errore standard</strong> della media (<span class="math inline">\(SE\)</span>) è:</p>
<p><span class="math display">\[
SE = \frac{s}{\sqrt{n}}
\]</span></p>
<p>In R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">standard_error</span> <span class="op">&lt;-</span> <span class="va">sample_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span></span>
<span><span class="va">standard_error</span></span>
<span><span class="co">#&gt; [1] 2.12</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Un intervallo di confidenza è definito come:</p>
<p><span class="math display">\[
\bar{X} \pm t_{\text{critico}} \cdot SE
\]</span></p>
<p>dove <span class="math inline">\(t_{\text{critico}}\)</span> è il valore critico della distribuzione <span class="math inline">\(t\)</span> di Student per un livello di confidenza del 95% (<span class="math inline">\(\alpha = 0.05\)</span>) e <span class="math inline">\(n-1\)</span> gradi di libertà. In R:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">sample_size</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="va">t_critical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="va">t_critical</span></span>
<span><span class="co">#&gt; [1] 2.09</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcoliamo il margine di errore:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">margin_of_error</span> <span class="op">&lt;-</span> <span class="va">t_critical</span> <span class="op">*</span> <span class="va">standard_error</span></span>
<span><span class="va">margin_of_error</span></span>
<span><span class="co">#&gt; [1] 4.44</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Calcoliamo i limiti inferiore e superiore dell’intervallo di confidenza:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">confidence_interval</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sample_mean</span> <span class="op">-</span> <span class="va">margin_of_error</span>, <span class="va">sample_mean</span> <span class="op">+</span> <span class="va">margin_of_error</span><span class="op">)</span></span>
<span><span class="va">confidence_interval</span></span>
<span><span class="co">#&gt; [1] 47.0 55.9</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Possiamo interpretare questo risultato dicendo che la procedura utilizzata per calcolare l’intervallo include il valore vero della media della popolazione nel 95% dei casi.</p>
<p>Creiamo un grafico per mostrare la distribuzione dei dati, la media campionaria e l’intervallo di confidenza:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">tibble</span><span class="op">(</span>Valori <span class="op">=</span> <span class="va">sample_data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Valori</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">..density..</span><span class="op">)</span>,</span>
<span>    bins <span class="op">=</span> <span class="fl">30</span>, <span class="co"># Puoi regolare il numero di bin</span></span>
<span>    fill <span class="op">=</span> <span class="st">"skyblue"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Linea per la media campionaria</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">sample_mean</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Linee per l'intervallo di confidenza</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">confidence_interval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">confidence_interval</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkgreen"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Titoli e assi</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Valori"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Densità"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Legenda personalizzata</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">sample_mean</span>, y <span class="op">=</span> <span class="fl">0.02</span>, label <span class="op">=</span> <span class="st">"Media campionaria"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"blue"</span>, angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">confidence_interval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0.02</span>, label <span class="op">=</span> <span class="st">"IC Inferiore"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkgreen"</span>, angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span><span class="st">"text"</span>,</span>
<span>    x <span class="op">=</span> <span class="va">confidence_interval</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, y <span class="op">=</span> <span class="fl">0.02</span>, label <span class="op">=</span> <span class="st">"IC Superiore"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"darkgreen"</span>, angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span></span>
<span>  <span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="03_conf_interv_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:85.0%"></p>
</figure>
</div>
</div>
</div>
<section id="confronto-tra-gli-approcci-frequentista-e-bayesiano" class="level4" data-number="4.7.1.1"><h4 data-number="4.7.1.1" class="anchored" data-anchor-id="confronto-tra-gli-approcci-frequentista-e-bayesiano">
<span class="header-section-number">4.7.1.1</span> Confronto tra gli Approcci Frequentista e Bayesiano</h4>
<p><strong>Intervallo di Credibilità Bayesiano:</strong></p>
<ul>
<li>Rappresenta il grado di credenza (posteriori) che il parametro <span class="math inline">\(\mu\)</span> si trovi all’interno dell’intervallo calcolato.</li>
<li>Dipende sia dai dati osservati sia dalle distribuzioni a priori utilizzate nel modello, che possono influenzare il risultato in base alla loro specificità o vaghezza.</li>
</ul>
<p><strong>Intervallo di Confidenza Frequentista:</strong></p>
<ul>
<li>Non esprime la probabilità che il parametro <span class="math inline">\(\mu\)</span> appartenga a un determinato intervallo.</li>
<li>Si riferisce invece alla procedura di costruzione dell’intervallo: se il campionamento fosse ripetuto infinite volte, il 95% degli intervalli costruiti conterrebbe il vero valore di <span class="math inline">\(\mu\)</span>.</li>
</ul>
<p>In sintesi:</p>
<ul>
<li>L’intervallo di credibilità bayesiano fornisce una stima probabilistica diretta e interpretabile della posizione di <span class="math inline">\(\mu\)</span>, basata su dati osservati e informazioni a priori.</li>
<li>L’intervallo di confidenza frequentista, invece, valuta la affidabilità della procedura nel lungo termine, senza fare affermazioni dirette sulla probabilità che il parametro rientri nell’intervallo specifico.</li>
</ul></section></section></section><section id="riflessioni-conclusive" class="level2" data-number="4.8"><h2 data-number="4.8" class="anchored" data-anchor-id="riflessioni-conclusive">
<span class="header-section-number">4.8</span> Riflessioni Conclusive</h2>
<p>Come sottolineato da <span class="citation" data-cites="hoekstra2014robust">Hoekstra et al. (<a href="#ref-hoekstra2014robust" role="doc-biblioref">2014</a>)</span>, è comune riscontrare fraintendimenti riguardo agli intervalli di fiducia. Il “livello di confidenza del 95%” è da interpretarsi come la probabilità a lungo termine che, in una serie di intervalli di fiducia calcolati, il 95% di essi includa il vero valore del parametro sconosciuto. Tuttavia, per un singolo intervallo di fiducia, non è possibile dichiarare con sicurezza che questo contenga effettivamente il parametro di interesse. In altre parole, la certezza sulla presenza del parametro sconosciuto all’interno di un dato intervallo di fiducia non è garantita per ogni singolo caso analizzato.</p>
<p>È inoltre inesatto presumere che esista un legame diretto tra la varianza e la media di un campione, ipotizzando che un intervallo di fiducia più ristretto implichi maggiore precisione. Nella prospettiva frequentista, la “precisione” è strettamente legata al livello di copertura a lungo termine assicurato dal metodo usato per creare gli intervalli di fiducia. Questo concetto non si applica al singolo intervallo di fiducia osservato. Dunque, un intervallo di fiducia che si presenta estremamente ristretto potrebbe in realtà essere significativamente lontano dal valore vero del parametro non noto.</p>
<p>È importante sottolineare che l’approccio frequentista offre un metodo per calcolare gli intervalli di confidenza per una vasta gamma di statistiche. Questo include, ad esempio, la stima dell’intervallo di confidenza per la differenza tra due medie, per una proporzione o per la differenza tra due proporzioni. Ecco le formule per calcolare gli intervalli di confidenza per i casi menzionati:</p>
<p><strong>Intervallo di confidenza per la differenza tra due medie.</strong></p>
<p>Se abbiamo due campioni indipendenti di dimensione <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span>, con medie <span class="math inline">\(\bar{x}_1\)</span> e <span class="math inline">\(\bar{x}_2\)</span> e deviazioni standard <span class="math inline">\(s_1\)</span> e <span class="math inline">\(s_2\)</span>, l’intervallo di confidenza per la differenza tra le medie è calcolato come:</p>
<p><span class="math display">\[
(\bar{x}_1 - \bar{x}_2) \pm t_{\alpha/2} \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}},
\]</span></p>
<p>dove <span class="math inline">\(t_{\alpha/2}\)</span> è il valore critico della distribuzione t di Student con <span class="math inline">\(\alpha/2\)</span> di probabilità di coda e gradi di libertà <span class="math inline">\(df = n_1 + n_2 - 2\)</span>.</p>
<p><strong>Intervallo di confidenza per una proporzione.</strong></p>
<p>Per stimare l’intervallo di confidenza per una proporzione <span class="math inline">\(p\)</span> in un campione binomiale di dimensione <span class="math inline">\(n\)</span>, la formula è:</p>
<p><span class="math display">\[
\hat{p} \pm z_{\alpha/2} \sqrt{\frac{\hat{p}(1 - \hat{p})}{n}},
\]</span></p>
<p>dove <span class="math inline">\(\hat{p}\)</span> è la proporzione campionaria e <span class="math inline">\(z_{\alpha/2}\)</span> è il valore critico della distribuzione normale standard con <span class="math inline">\(\alpha/2\)</span> di probabilità di coda.</p>
<p><strong>Intervallo di confidenza per la differenza tra due proporzioni.</strong></p>
<p>Per stimare l’intervallo di confidenza per la differenza tra due proporzioni <span class="math inline">\(p_1\)</span> e <span class="math inline">\(p_2\)</span> in due campioni binomiali di dimensioni <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span>, la formula è:</p>
<p><span class="math display">\[
(\hat{p}_1 - \hat{p}_2) \pm z_{\alpha/2} \sqrt{\frac{\hat{p}_1(1 - \hat{p}_1)}{n_1} + \frac{\hat{p}_2(1 - \hat{p}_2)}{n_2}},
\]</span></p>
<p>dove <span class="math inline">\(\hat{p}_1\)</span> e <span class="math inline">\(\hat{p}_2\)</span> sono le proporzioni campionarie e <span class="math inline">\(z_{\alpha/2}\)</span> è il valore critico della distribuzione normale standard con <span class="math inline">\(\alpha/2\)</span> di probabilità di coda.</p>
</section><section id="esercizi" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="esercizi">Esercizi</h2>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi 1">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li><p>Che cos’è un intervallo di confidenza dal punto di vista frequentista?</p></li>
<li><p>Che cosa significa la copertura al 95% di un intervallo di confidenza?</p></li>
<li><p>Perché non è corretto dire che “c’è il 95% di probabilità che il valore vero di <span class="math inline">\(\mu\)</span> cada in questo intervallo di confidenza”?</p></li>
<li><p>In cosa consiste la differenza tra un intervallo di confidenza costruito con la distribuzione normale standard <span class="math inline">\(Z\)</span> e uno costruito con la distribuzione <span class="math inline">\(t\)</span> di Student?</p></li>
<li><p>Perché, nel caso di varianza incognita, si usa la deviazione standard campionaria <span class="math inline">\(s\)</span> al posto di <span class="math inline">\(\sigma\)</span>?</p></li>
<li><p>Come influenza la dimensione del campione <span class="math inline">\(n\)</span> l’ampiezza dell’intervallo di confidenza?</p></li>
<li><p>Perché gli intervalli di confidenza frequentisti si basano su un concetto di “ripetizione dell’esperimento” nel lungo periodo?</p></li>
<li><p>Quali sono due fraintendimenti comuni sugli intervalli di confidenza?</p></li>
<li><p>Come si interpreta correttamente un intervallo di confidenza al 95%?</p></li>
<li><p>Qual è la differenza essenziale tra un intervallo di confidenza frequentista e un intervallo di credibilità bayesiano?</p></li>
</ol>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni 1">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni 1
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ol type="1">
<li>Che cos’è un intervallo di confidenza dal punto di vista frequentista?</li>
</ol>
<p><strong>Risposta</strong><br>
Un intervallo di confidenza (IC) è un range di valori costruito attorno a una stima campionaria (ad esempio, la media campionaria) che, secondo il metodo frequentista adottato, conterrà il valore vero del parametro in una certa proporzione di casi (ad esempio il 95%) se si ripetesse l’esperimento (ossia il campionamento) un numero molto grande di volte. Non esprime dunque la “probabilità” che il parametro sia dentro l’intervallo in un singolo caso, ma una frequenza di successo nel lungo periodo.</p>
<ol start="2" type="1">
<li>Che cosa significa la copertura al 95% di un intervallo di confidenza?</li>
</ol>
<p><strong>Risposta</strong><br>
Il livello di copertura (ad esempio, 95%) indica che, in una serie ipotetica di infiniti campioni indipendenti e nel calcolo ripetuto di infiniti intervalli di confidenza secondo la stessa procedura, il 95% di tali intervalli conterrà il valore vero del parametro. È una proprietà della procedura di costruzione degli intervalli, non di un singolo intervallo già calcolato.</p>
<ol start="3" type="1">
<li>Perché non è corretto dire che “c’è il 95% di probabilità che il valore vero di <span class="math inline">\(\mu\)</span> cada in questo intervallo di confidenza”?</li>
</ol>
<p><strong>Risposta</strong><br>
Nella prospettiva frequentista, il parametro <span class="math inline">\(\mu\)</span> è considerato un valore fisso (non una variabile casuale). L’incertezza risiede nel campione e nella procedura di costruzione dell’intervallo, non nel parametro. Di conseguenza, non si può associare una probabilità alla posizione di <span class="math inline">\(\mu\)</span> all’interno di un singolo intervallo: l’intervallo o contiene <span class="math inline">\(\mu\)</span> oppure no, senza mezze misure probabilistiche.</p>
<ol start="4" type="1">
<li>In cosa consiste la differenza tra un intervallo di confidenza costruito con la distribuzione normale standard <span class="math inline">\(Z\)</span> e uno costruito con la distribuzione <span class="math inline">\(t\)</span> di Student?</li>
</ol>
<p><strong>Risposta</strong><br>
- <strong>Distribuzione <span class="math inline">\(Z\)</span></strong>: si utilizza quando la varianza della popolazione <span class="math inline">\(\sigma^2\)</span> è nota (o si approssima molto bene) e la popolazione è normalmente distribuita, o quando il campione è molto grande (per applicare il teorema del limite centrale).<br>
- <strong>Distribuzione <span class="math inline">\(t\)</span></strong>: si impiega quando la varianza <span class="math inline">\(\sigma^2\)</span> non è nota e bisogna stimarla con la deviazione standard campionaria <span class="math inline">\(s\)</span>. La distribuzione <span class="math inline">\(t\)</span> “corregge” per l’incertezza aggiuntiva dovuta alla stima di <span class="math inline">\(\sigma\)</span> e diventa progressivamente simile alla normale standard quando il numero di gradi di libertà (cioè la dimensione del campione meno uno) è elevato.</p>
<ol start="5" type="1">
<li>Perché, nel caso di varianza incognita, si usa la deviazione standard campionaria <span class="math inline">\(s\)</span> al posto di <span class="math inline">\(\sigma\)</span>?</li>
</ol>
<p><strong>Risposta</strong><br>
Quando <span class="math inline">\(\sigma\)</span> non è nota, la si sostituisce con la stima campionaria <span class="math inline">\(s\)</span>. Poiché <span class="math inline">\(s\)</span> è anch’essa una variabile casuale (cioè dipende dai dati osservati), introduce un’ulteriore fonte di incertezza. Questo giustifica l’uso della distribuzione <span class="math inline">\(t\)</span> di Student anziché della normale standard, poiché <span class="math inline">\(t\)</span> ingloba tale incertezza aggiuntiva.</p>
<ol start="6" type="1">
<li>Come influenza la dimensione del campione <span class="math inline">\(n\)</span> l’ampiezza dell’intervallo di confidenza?</li>
</ol>
<p><strong>Risposta</strong><br>
Aumentando <span class="math inline">\(n\)</span>, l’errore standard della media (cioè <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span> oppure <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>) diminuisce. Di conseguenza, l’intervallo di confidenza si restringe (a parità di livello di confidenza). In altre parole, con più dati a disposizione la stima della media è più “precisa” nel senso frequentista, e ciò si riflette in un IC più stretto.</p>
<ol start="7" type="1">
<li>Perché gli intervalli di confidenza frequentisti si basano su un concetto di “ripetizione dell’esperimento” nel lungo periodo?</li>
</ol>
<p><strong>Risposta</strong><br>
La filosofia frequentista definisce la probabilità come una frequenza relativa di un evento dopo molteplici repliche dell’esperimento. Per gli intervalli di confidenza, ciò implica che la probabilità di copertura (ad esempio 95%) è intesa come la frequenza con cui, ripetendo infinite volte il campionamento e la costruzione di IC allo stesso modo, l’intervallo calcolato conterrà il vero parametro. Non riguarda invece la probabilità del parametro di trovarsi in un intervallo specifico.</p>
<ol start="8" type="1">
<li>Quali sono due fraintendimenti comuni sugli intervalli di confidenza?</li>
</ol>
<p><strong>Risposta</strong><br>
1. <strong>Credere che l’IC fornisca una probabilità diretta di contenere il parametro</strong> (es. “c’è il 95% di probabilità che <span class="math inline">\(\mu\)</span> sia qui dentro”) – in realtà, nel frequentismo <span class="math inline">\(\mu\)</span> è fisso e l’IC varia.<br>
2. <strong>Pensare che l’intervallo di confidenza sia significativo per la singola stima più che per la procedura</strong> – in realtà, il 95% di copertura si riferisce alla ripetizione dell’esperimento, non a un singolo intervallo.</p>
<ol start="9" type="1">
<li>Come si interpreta correttamente un intervallo di confidenza al 95%?</li>
</ol>
<p><strong>Risposta</strong><br>
“Se ripetiamo più volte l’esperimento, ossia estraiamo molti campioni indipendenti dalla popolazione e costruiamo ogni volta un intervallo di confidenza con la stessa procedura, allora il 95% di quegli intervalli conterrà il valore vero della media <span class="math inline">\(\mu\)</span>.” È dunque una garanzia circa l’efficacia della metodologia nel lungo periodo.</p>
<ol start="10" type="1">
<li>Qual è la differenza essenziale tra un intervallo di confidenza frequentista e un intervallo di credibilità bayesiano?</li>
</ol>
<p><strong>Risposta</strong><br>
- <strong>Intervallo di confidenza frequentista</strong>: descrive la performance a lungo termine di una procedura; non permette di affermare “la probabilità che <span class="math inline">\(\mu\)</span> sia nell’intervallo è il 95%”.<br>
- <strong>Intervallo di credibilità bayesiano</strong>: esprime direttamente una credenza probabilistica a posteriori sul parametro (ad esempio, “c’è il 95% di probabilità che <span class="math inline">\(\mu\)</span> sia in questo intervallo”), perché il parametro è trattato come variabile casuale, con una distribuzione a priori che si aggiorna con i dati osservati.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi 2">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Di seguito trovi <strong>10 esercizi</strong> incentrati sulla costruzione di intervalli di confidenza. I primi 5 richiedono di svolgere i calcoli “a mano” (carta e penna o calcolatrice), gli ultimi 5 prevedono l’utilizzo di <strong>R</strong>.</p>
<p><strong>Esercizi da Risolvere “a Mano”</strong></p>
<ol type="1">
<li>Intervallo di Confidenza per la Media (Varianza Nota)</li>
</ol>
<p>Una ricercatrice vuole stimare la media di un punteggio di <strong>reattività emotiva</strong> (scala 0–100) in giovani adulti. Dai dati precedenti, si sa che la <strong>varianza</strong> vera (della popolazione) è <span class="math inline">\(\sigma^2 = 16\)</span>. Si raccoglie un campione di <span class="math inline">\(n=25\)</span> partecipanti e la <strong>media campionaria</strong> risulta <span class="math inline">\(\bar{X} = 45\)</span>.<br>
1. Calcola l’intervallo di confidenza al 95% per la media della popolazione (<span class="math inline">\(\mu\)</span>).<br>
2. Fornisci un’interpretazione corretta (frequentista) del risultato.</p>
<ol start="2" type="1">
<li>Intervallo di Confidenza per la Media (Varianza Incognita, 99%)</li>
</ol>
<p>In un’indagine sulla <strong>soddisfazione lavorativa</strong> (scala da 1 a 7), vengono coinvolti <span class="math inline">\(n=10\)</span> psicologi clinici. I dati raccolti forniscono:<br>
- Media campionaria <span class="math inline">\(\bar{X} = 5{,}6\)</span><br>
- Deviazione standard campionaria <span class="math inline">\(s=0{,}8\)</span><br>
La popolazione è considerata approssimativamente normale ma la varianza è ignota. Calcola l’IC al 99% per la vera media di soddisfazione <span class="math inline">\(\mu\)</span>.</p>
<ol start="3" type="1">
<li>Intervallo di Confidenza per la Differenza tra Due Medie (Varianze Incognite Uguali)</li>
</ol>
<p>Un team di psicologi del lavoro vuole confrontare i <strong>livelli di stress</strong> (scala 0–50) tra due gruppi di dipendenti di un’azienda (Campione 1: reparto A, Campione 2: reparto B). I dati sono:</p>
<ul>
<li><p><strong>Reparto A</strong> (<span class="math inline">\(n_1=12\)</span>):<br><span class="math inline">\(\bar{X}_1 = 22\)</span>, <span class="math inline">\(s_1 = 4\)</span></p></li>
<li><p><strong>Reparto B</strong> (<span class="math inline">\(n_2=10\)</span>):<br><span class="math inline">\(\bar{X}_2 = 19\)</span>, <span class="math inline">\(s_2 = 3{,}5\)</span></p></li>
</ul>
<p>Assumi che le due popolazioni siano normali con varianze ignote ma <strong>uguali</strong> e calcola l’intervallo di confidenza al 95% per <span class="math inline">\(\mu_A - \mu_B\)</span>. (Usa quindi la formula con la varianza pooled.)</p>
<ol start="4" type="1">
<li>Intervallo di Confidenza per una Proporzione</li>
</ol>
<p>Uno studio pilota su un <strong>programma di training per la gestione dell’ansia</strong> vede 120 persone iscriversi. Alla fine del programma, 48 di loro riportano di aver diminuito la frequenza di attacchi di panico in modo “significativo”.<br>
1. Stima la proporzione campionaria <span class="math inline">\(\hat{p}\)</span>.<br>
2. Calcola l’IC al 95% per la vera proporzione <span class="math inline">\(p\)</span> di persone che trarrebbe beneficio “significativo” dal programma.</p>
<ol start="5" type="1">
<li>Intervallo di Confidenza per la Differenza tra Due Proporzioni</li>
</ol>
<p>In un esperimento, due gruppi di partecipanti ricevono diversi <strong>percorsi di psicoterapia</strong> per ridurre l’insonnia:</p>
<ul>
<li>
<strong>Gruppo 1</strong> (<span class="math inline">\(n_1=50\)</span>): 35 persone riportano un netto miglioramento del sonno.<br>
</li>
<li>
<strong>Gruppo 2</strong> (<span class="math inline">\(n_2=40\)</span>): 20 persone riportano un netto miglioramento del sonno.</li>
</ul>
<p>Si vuole stimare la differenza <span class="math inline">\((p_1 - p_2)\)</span> nelle proporzioni di successo dei due trattamenti. Calcola l’IC al 95%.</p>
<p><strong>Esercizi da Risolvere con R</strong></p>
<p>Nei prossimi esercizi, utilizza R per effettuare i calcoli. I dati sono già contestualizzati in ambito psicologico.</p>
<ol start="6" type="1">
<li>Intervallo di Confidenza per la Media (Varianza Incognita)</li>
</ol>
<p>Hai misurato i <strong>tempi di reazione</strong> (in millisecondi) a uno stimolo di pericolo in un gruppo di 15 partecipanti. I dati (approssimati) sono:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reaction_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">250</span>, <span class="fl">210</span>, <span class="fl">240</span>, <span class="fl">260</span>, <span class="fl">270</span>, <span class="fl">225</span>, <span class="fl">255</span>, <span class="fl">235</span>, <span class="fl">245</span>, <span class="fl">210</span>, <span class="fl">270</span>, <span class="fl">265</span>, <span class="fl">220</span>, <span class="fl">230</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li>Utilizza R per calcolare la media e la deviazione standard campionaria.<br>
</li>
<li>Costruisci (tramite <code>t.test(reaction_times)</code>) l’intervallo di confidenza al 95% per il tempo di reazione medio della popolazione.</li>
</ol>
<ol start="7" type="1">
<li>Intervallo di Confidenza per la Differenza tra Due Medie (Varianze Incognite)</li>
</ol>
<p>Due gruppi di studenti hanno svolto un test di <strong>memoria verbale</strong> dopo aver seguito differenti strategie di studio:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">groupA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">18</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">16</span>, <span class="fl">19</span>, <span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">groupB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">9</span>, <span class="fl">14</span>, <span class="fl">11</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">15</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li>Calcola in R le medie campionarie dei due gruppi.<br>
</li>
<li>Utilizza <code>t.test(groupA, groupB, var.equal = FALSE)</code> per ottenere l’IC al 95% della differenza <span class="math inline">\(\mu_A - \mu_B\)</span>.<br>
</li>
<li>Riporta i risultati numerici.</li>
</ol>
<ol start="8" type="1">
<li>Intervallo di Confidenza per una Proporzione (Studio su Fobia Specifica)</li>
</ol>
<p>In un piccolo studio, hai i dati (binari: 1 = “attacco d’ansia”, 0 = “nessun attacco”) raccolti da 20 persone <strong>esposte a uno stimolo fobico</strong>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">attacks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li>Calcola in R la proporzione campionaria di attacchi d’ansia.<br>
</li>
<li>Utilizza <code><a href="https://rdrr.io/r/stats/prop.test.html">prop.test()</a></code> per costruire l’IC al 95% per la proporzione vera di attacchi d’ansia in questa specifica situazione.</li>
</ol>
<ol start="9" type="1">
<li>Intervallo di Confidenza per la Differenza tra Due Proporzioni (Test A/B di un Training Psicologico)</li>
</ol>
<p>Due <strong>versioni</strong> di un training psicologico anti-stress (A e B) sono state testate su studenti universitari, registrando (binario: 1/0) se al termine del corso mostrano ridotti livelli di stress:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">versionA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">versionB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol type="1">
<li>Calcola in R <span class="math inline">\(\hat{p}_A\)</span> e <span class="math inline">\(\hat{p}_B\)</span>.<br>
</li>
<li>Usa <code>prop.test(x = ..., n = ...)</code> per l’IC al 95% di <span class="math inline">\((p_A - p_B)\)</span>.<br>
</li>
<li>Riporta i risultati.</li>
</ol>
<ol start="10" type="1">
<li>Simulazione di Copertura per l’IC sulla Media (Contesto Psicologico)</li>
</ol>
<p>Scrivi (o completa) uno script in R che simuli 1000 campioni di <strong>punteggi di ansia</strong> (scala 0–80) estratti da una distribuzione approssimata come Normale, con media vera <span class="math inline">\(\mu=40\)</span> e <span class="math inline">\(\sigma=10\)</span>. Per ogni campione di ampiezza <span class="math inline">\(n=25\)</span>:</p>
<ol type="1">
<li>Calcola la media campionaria e la deviazione standard.<br>
</li>
<li>Costruisci l’IC al 95% (usando la distribuzione t).<br>
</li>
<li>Verifica quante volte l’intervallo contiene il vero valore <span class="math inline">\(\mu = 40\)</span>.<br>
</li>
<li>Stima la proporzione di copertura e commenta se è prossima a 0,95.</li>
</ol>
<p>Esempio di traccia:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">count_included</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="co"># calcola media, sd, IC, verifica se 40 è dentro l’IC</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="va">count_included</span> <span class="op">/</span> <span class="va">n_sims</span></span>
<span><span class="va">coverage</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni 2">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni 2
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Soluzioni Esercizi “a Mano”</strong></p>
<p>Soluzione 1</p>
<ul>
<li>Dati: <span class="math inline">\(\sigma^2=16 \implies \sigma=4\)</span>; <span class="math inline">\(n=25\)</span>; <span class="math inline">\(\bar{X}=45\)</span>; livello di confidenza 95% (<span class="math inline">\(\alpha=0{,}05\)</span>).<br>
</li>
<li>Errore standard:<br><span class="math display">\[
\text{SE} = \frac{\sigma}{\sqrt{n}} = \frac{4}{5} = 0{,}8.
\]</span><br>
</li>
<li>Valore critico <span class="math inline">\(z_{\alpha/2}\approx 1{,}96\)</span>.<br>
</li>
<li>Margine di errore:<br><span class="math display">\[
E = z_{\alpha/2} \times \text{SE} \approx 1{,}96 \times 0{,}8 = 1{,}57.
\]</span><br>
</li>
<li>IC 95%:<br><span class="math display">\[
45 \pm 1{,}57 \quad \Rightarrow \quad (43{,}43;\, 46{,}57).
\]</span>
</li>
</ul>
<p>Soluzione 2</p>
<ul>
<li>Dati: <span class="math inline">\(n=10\)</span>, <span class="math inline">\(\bar{X}=5{,}6\)</span>, <span class="math inline">\(s=0{,}8\)</span>, confidenza 99% (<span class="math inline">\(\alpha=0{,}01\)</span>).<br>
</li>
<li>Gradi di libertà <span class="math inline">\(df = 9\)</span>. Il valore di <span class="math inline">\(t_{\alpha/2, df=9}\)</span> (per <span class="math inline">\(\alpha/2=0{,}005\)</span>) è approssimativamente <strong>3,25</strong> (dipende dalla tabella).<br>
</li>
<li>Errore standard:<br><span class="math display">\[
\text{SE} = \frac{s}{\sqrt{n}} = \frac{0{,}8}{\sqrt{10}} \approx \frac{0{,}8}{3{,}162} \approx 0{,}253.
\]</span><br>
</li>
<li>Margine di errore:<br><span class="math display">\[
E = 3{,}25 \times 0{,}253 \approx 0{,}82.
\]</span><br>
</li>
<li>IC al 99%:<br><span class="math display">\[
5{,}6 \pm 0{,}82 \quad \Rightarrow \quad (4{,}78;\, 6{,}42).
\]</span>
</li>
</ul>
<p>Soluzione 3</p>
<ul>
<li>Dati:
<ul>
<li>Campione 1 (A): <span class="math inline">\(n_1=12\)</span>, <span class="math inline">\(\bar{X}_1=22\)</span>, <span class="math inline">\(s_1=4\)</span>.<br>
</li>
<li>Campione 2 (B): <span class="math inline">\(n_2=10\)</span>, <span class="math inline">\(\bar{X}_2=19\)</span>, <span class="math inline">\(s_2=3{,}5\)</span>.<br>
</li>
<li>IC 95% <span class="math inline">\(\Rightarrow \alpha=0{,}05\)</span>.<br>
</li>
<li>Si assume varianza uguale (<span class="math inline">\(\sigma_A^2 = \sigma_B^2\)</span>) <span class="math inline">\(\Rightarrow\)</span> varianza pooled.</li>
</ul>
</li>
</ul>
<ol type="1">
<li>Varianza campionaria: <span class="math inline">\(s_1^2=16\)</span>, <span class="math inline">\(s_2^2=12{,}25\)</span>.<br>
</li>
<li>Varianza pooled:<br><span class="math display">\[
s_p^2
= \frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}
= \frac{(11 \times 16) + (9 \times 12{,}25)}{12 + 10 - 2}.
\]</span> <span class="math display">\[
= \frac{176 + 110{,}25}{20}
= \frac{286{,}25}{20}
= 14{,}3125.
\]</span> <span class="math display">\[
s_p = \sqrt{14{,}3125} \approx 3{,}785.
\]</span>
</li>
<li>Errore standard della differenza:<br><span class="math display">\[
\text{SE}(\bar{X}_1 - \bar{X}_2)
= \sqrt{\,s_p^2\!\left(\tfrac{1}{n_1} + \tfrac{1}{n_2}\right)}
= \sqrt{\,14{,}3125 \times \left(\tfrac{1}{12} + \tfrac{1}{10}\right)}.
\]</span> <span class="math display">\[
\tfrac{1}{12} + \tfrac{1}{10} = 0{,}0833 + 0{,}1 = 0{,}1833.
\]</span> <span class="math display">\[
14{,}3125 \times 0{,}1833 \approx 2{,}624
\quad \Rightarrow \quad \sqrt{2{,}624} \approx 1{,}62.
\]</span>
</li>
<li>Differenza campionaria: <span class="math inline">\(\bar{X}_1 - \bar{X}_2 = 3\)</span>.<br>
</li>
<li>Valore critico <span class="math inline">\(t_{\alpha/2}\)</span> con <span class="math inline">\(df = n_1 + n_2 - 2 = 20\)</span>: circa <strong>2,086</strong>.<br>
</li>
<li>Margine di errore: <span class="math inline">\(E \approx 2{,}086 \times 1{,}62 \approx 3{,}38\)</span>.<br>
</li>
<li>IC 95%:<br><span class="math display">\[
3 \pm 3{,}38 \quad \Rightarrow \quad (-0{,}38;\, 6{,}38).
\]</span> <em>(Approssimando: i valori variano un po’ in base agli arrotondamenti.)</em>
</li>
</ol>
<p>Soluzione 4</p>
<ul>
<li>Dati: <span class="math inline">\(n=120\)</span>, successo <span class="math inline">\(x=48\)</span>.<br>
</li>
<li>
<span class="math inline">\(\hat{p} = \frac{48}{120}=0{,}4\)</span>.<br>
</li>
<li>Errore standard (approssimazione normale):<br><span class="math display">\[
\sqrt{\frac{\hat{p}(1-\hat{p})}{n}} = \sqrt{\frac{0{,}4 \times 0{,}6}{120}} = \sqrt{\frac{0{,}24}{120}} = \sqrt{0{,}002} \approx 0{,}0447.
\]</span>
</li>
<li>Con <span class="math inline">\(\alpha=0{,}05\)</span>, <span class="math inline">\(z_{\alpha/2} \approx 1{,}96\)</span>.<br>
</li>
<li>Margine di errore:<br><span class="math display">\[
E = 1{,}96 \times 0{,}0447 \approx 0{,}0876.
\]</span>
</li>
<li>IC 95%:<br><span class="math display">\[
0{,}4 \pm 0{,}0876 \quad \Rightarrow \quad (0{,}3124;\, 0{,}4876).
\]</span>
</li>
</ul>
<p>Soluzione 5</p>
<ul>
<li>Dati:
<ul>
<li>Gruppo 1 (<span class="math inline">\(n_1=50\)</span>): 35 successi <span class="math inline">\(\Rightarrow \hat{p}_1=35/50=0{,}70\)</span>.<br>
</li>
<li>Gruppo 2 (<span class="math inline">\(n_2=40\)</span>): 20 successi <span class="math inline">\(\Rightarrow \hat{p}_2=20/40=0{,}50\)</span>.<br>
</li>
</ul>
</li>
<li>Differenza: <span class="math inline">\(\hat{p}_1 - \hat{p}_2=0{,}20\)</span>.<br>
</li>
<li>Errore standard:<br><span class="math display">\[
\sqrt{\frac{0{,}70 \cdot 0{,}30}{50} + \frac{0{,}50 \cdot 0{,}50}{40}}
= \sqrt{\frac{0{,}21}{50} + \frac{0{,}25}{40}}
= \sqrt{0{,}0042 + 0{,}00625}
= \sqrt{0{,}01045} \approx 0{,}1022.
\]</span>
</li>
<li>Margine di errore (al 95%, <span class="math inline">\(z_{\alpha/2}=1{,}96\)</span>):<br><span class="math display">\[
1{,}96 \times 0{,}1022 \approx 0{,}200.
\]</span>
</li>
<li>IC 95%:<br><span class="math display">\[
0{,}20 \pm 0{,}20 \quad \Rightarrow \quad (0{,}00;\, 0{,}40).
\]</span> *(Può capitare un limite inferiore esattamente 0, se si arrotonda.)</li>
</ul>
<p><strong>Soluzioni Esercizi con R</strong></p>
<p><em>(I risultati possono variare leggermente a seconda della versione di R e di eventuali correzioni di continuità nelle funzioni di test.)</em></p>
<p>Soluzione 6</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">reaction_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">220</span>, <span class="fl">250</span>, <span class="fl">210</span>, <span class="fl">240</span>, <span class="fl">260</span>, <span class="fl">270</span>, <span class="fl">225</span>, <span class="fl">255</span>, <span class="fl">235</span>, <span class="fl">245</span>, <span class="fl">210</span>, <span class="fl">270</span>, <span class="fl">265</span>, <span class="fl">220</span>, <span class="fl">230</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">reaction_times</span><span class="op">)</span>         <span class="co"># media</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">reaction_times</span><span class="op">)</span>           <span class="co"># deviazione standard</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">reaction_times</span><span class="op">)</span>       <span class="co"># t.test con conf.level = 0.95 di default</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Esempio di risultato:
<ul>
<li>Media campionaria <span class="math inline">\(\bar{X}\approx 240\)</span> (dipende dai dati esatti)<br>
</li>
<li>
<code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> riporta un IC 95% (ad es.): <span class="math inline">\((230, 250)\)</span> [numeri a titolo di esempio].</li>
</ul>
</li>
</ul>
<p>Soluzione 7</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">groupA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">12</span>, <span class="fl">18</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">16</span>, <span class="fl">19</span>, <span class="fl">11</span><span class="op">)</span></span>
<span><span class="va">groupB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">9</span>, <span class="fl">14</span>, <span class="fl">11</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">groupA</span><span class="op">)</span>  <span class="co"># ~ 14.375</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">groupB</span><span class="op">)</span>  <span class="co"># ~ 11.50</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">groupA</span>, <span class="va">groupB</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>
<p>Esempio di output (fittizio):</p>
<pre><code>Welch Two Sample t-test
data:  groupA and groupB
t = 2.35, df = 13.7, p-value = 0.033
95 percent confidence interval:
  0.47  5.77
sample estimates:
  mean of x  mean of y 
      14.375     11.500</code></pre>
<p>Quindi l’IC 95% per <span class="math inline">\(\mu_A - \mu_B\)</span> potrebbe essere circa <span class="math inline">\((0{,}47;\, 5{,}77)\)</span>.</p>
</li>
</ul>
<p>Soluzione 8</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">attacks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">attacks</span><span class="op">)</span>        <span class="co"># conta quanti "1"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">attacks</span><span class="op">)</span>     <span class="co"># 20</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">attacks</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">attacks</span><span class="op">)</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Se, ad esempio, vi fossero 12 “1” su 20, <span class="math inline">\(\hat{p}=0{,}60\)</span>.<br>
</li>
<li>L’intervallo di confidenza al 95% (a seconda della continuity correction) potrebbe essere indicativamente <span class="math inline">\((0{,}36;\, 0{,}80)\)</span>.</li>
</ul>
<p>Soluzione 9</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">versionA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">versionB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sumA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">versionA</span><span class="op">)</span></span>
<span><span class="va">sumB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">versionB</span><span class="op">)</span></span>
<span><span class="va">nA</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">versionA</span><span class="op">)</span></span>
<span><span class="va">nB</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">versionB</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html">prop.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">sumA</span>,<span class="va">sumB</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">nA</span>,<span class="va">nB</span><span class="op">)</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Esempio:
<ul>
<li>
<code>sum(versionA)</code> = 8 successi su 12 (<span class="math inline">\(\hat{p}_A=0{,}666...\)</span>)<br>
</li>
<li>
<code>sum(versionB)</code> = 5 successi su 12 (<span class="math inline">\(\hat{p}_B=0{,}416...\)</span>)<br>
</li>
<li>L’IC per <span class="math inline">\(\hat{p}_A - \hat{p}_B\)</span> potrebbe essere, ad esempio, <span class="math inline">\((-0{,}05;\, 0{,}61)\)</span>.</li>
</ul>
</li>
</ul>
<p><em>(I numeri esatti variano a seconda dell’eventuale correzione di continuità.)</em></p>
<p>Soluzione 10</p>
<p>Un possibile script:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n_sims</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fl">10</span></span>
<span></span>
<span><span class="va">count_included</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_sims</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">sample_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="va">mu</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span>  <span class="va">xbar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span>  <span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">sample_data</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># t critico</span></span>
<span>  <span class="va">t_crit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="fl">0.975</span>, df <span class="op">=</span> <span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># IC</span></span>
<span>  <span class="va">se</span> <span class="op">&lt;-</span> <span class="va">s</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>  <span class="va">E</span> <span class="op">&lt;-</span> <span class="va">t_crit</span> <span class="op">*</span> <span class="va">se</span></span>
<span>  <span class="va">lower</span> <span class="op">&lt;-</span> <span class="va">xbar</span> <span class="op">-</span> <span class="va">E</span></span>
<span>  <span class="va">upper</span> <span class="op">&lt;-</span> <span class="va">xbar</span> <span class="op">+</span> <span class="va">E</span></span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">mu</span> <span class="op">&gt;=</span> <span class="va">lower</span> <span class="op">&amp;</span> <span class="va">mu</span> <span class="op">&lt;=</span> <span class="va">upper</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">count_included</span> <span class="op">&lt;-</span> <span class="va">count_included</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">coverage</span> <span class="op">&lt;-</span> <span class="va">count_included</span> <span class="op">/</span> <span class="va">n_sims</span></span>
<span><span class="va">coverage</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>
<p>Esempio di risultato:</p>
<pre><code>&gt; coverage
[1] 0.948</code></pre>
<p>Ovvero ~94,8% degli IC contengono il vero valore <span class="math inline">\(\mu=40\)</span>, in linea con il 95% atteso (piccole differenze dovute al caso).</p>
</li>
</ul>
<p><strong>Commento Conclusivo</strong></p>
<p>In ogni caso, ricorda sempre che <strong>l’interpretazione frequentista</strong> di un intervallo di confidenza si basa sulla “copertura a lungo termine” del metodo di costruzione dell’IC, non sulla probabilità che il vero parametro cada nell’intervallo specifico appena calcolato.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-important no-icon callout-titled" title="Problemi 3">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Problemi 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Esercizio 1 – Calcolo e interpretazione dell’IC frequentista per la media</strong></p>
<ol type="1">
<li>
<strong>Calcola la media campionaria</strong> <span class="math inline">\(\bar{X}\)</span> e la <strong>deviazione standard campionaria</strong> <span class="math inline">\(s\)</span>.<br>
</li>
<li>Assumendo che il punteggio SWLS nella popolazione di riferimento (ad esempio, “giovani adulti universitari”) sia <strong>approssimativamente normale</strong> ma con varianza sconosciuta, costruisci l’<strong>intervallo di confidenza al 95%</strong> per la media <span class="math inline">\(\mu\)</span> utilizzando la distribuzione <span class="math inline">\(t\)</span> di Student con <span class="math inline">\(n - 1\)</span> gradi di libertà (dove <span class="math inline">\(n=10\)</span>).<br>
</li>
<li>
<strong>Interpreta</strong> questo intervallo di confidenza in ottica <strong>frequentista</strong>. Metti in evidenza la distinzione fra l’“interpretazione corretta” (copertura sul lungo periodo) e l’“interpretazione scorretta” (credere che ci sia il 95% di probabilità che <span class="math inline">\(\mu\)</span> stia nell’intervallo calcolato).</li>
</ol>
<p><strong>Spunti di riflessione sui limiti</strong>:<br>
- Con un <strong>campione molto piccolo</strong>, l’intervallo di confidenza potrebbe essere <strong>molto ampio</strong>.<br>
- Se la <strong>popolazione</strong> non fosse davvero normale, la validità dell’IC con distribuzione <span class="math inline">\(t\)</span> potrebbe essere compromessa.<br>
- In ottica frequentista, il singolo intervallo o contiene il vero valore di <span class="math inline">\(\mu\)</span> o non lo contiene: la “probabilità 95%” si riferisce alla procedura di costruzione, non a questo singolo intervallo specifico.</p>
<p><strong>Esercizio 2 – Sensibilità dell’IC a diversi livelli di confidenza</strong></p>
<ol type="1">
<li>Utilizzando gli <strong>stessi 10 dati</strong>, calcola:
<ul>
<li>l’intervallo di confidenza all’<strong>80%</strong><br>
</li>
<li>l’intervallo di confidenza al <strong>99%</strong><br>
</li>
</ul>
</li>
<li>Confronta <strong>l’ampiezza</strong> dei tre intervalli (80%, 95%, 99%).<br>
</li>
<li>Commenta dal punto di vista dell’<strong>interpretazione frequentista</strong>: perché l’IC al 99% è più ampio di quello al 95%, e quest’ultimo è più ampio di quello all’80%?</li>
</ol>
<p><strong>Spunti di riflessione sui limiti</strong>:<br>
- Aumentare il <strong>livello di confidenza</strong> fa sì che l’<strong>IC si allarghi</strong>, spesso di molto se <span class="math inline">\(n\)</span> è piccolo.<br>
- Un IC più ampio rassicura sulla “copertura” nel lungo periodo, ma è <strong>meno informativo</strong> per il singolo studio.</p>
<p><strong>Esercizio 3 – Utilizzo di software per il calcolo (ad esempio, R o altro)</strong></p>
<ol type="1">
<li>
<p>Inserisci i dati in un software (come R). Puoi farlo in R con:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">swls_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">28</span>, <span class="fl">22</span>, <span class="fl">26</span>, <span class="fl">18</span>, <span class="fl">30</span>, <span class="fl">24</span>, <span class="fl">27</span>, <span class="fl">17</span>, <span class="fl">21</span>, <span class="fl">25</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</li>
<li>
<p>Calcola la media e la deviazione standard in R, poi utilizza la funzione <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">swls_data</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</li>
<li><p>Riporta l’<strong>intervallo di confidenza</strong> ottenuto e confrontalo con quello calcolato a mano.<br></p></li>
<li><p><strong>Commenta</strong> eventuali <strong>differenze</strong> (minime) dovute agli <strong>arrotondamenti</strong> o a correzioni interne di R.<br></p></li>
<li><p>Ribadisci la <strong>corretta interpretazione frequentista</strong>: se si ripetesse lo stesso studio molte volte (stessa dimensione campionaria, stesso contesto di popolazione, stessa procedura di calcolo), il 95% di questi IC conterrebbe il valore vero di <span class="math inline">\(\mu\)</span>.</p></li>
</ol>
<p><strong>Esercizio 4 – Confronto pratico e riflessioni critiche</strong></p>
<ol type="1">
<li>Immagina di avere un’<strong>ipotesi</strong>: “La media SWLS nella popolazione dei giovani adulti universitari è pari a 24” (un’ipotesi plausibile se la scala totale va da 5 a 35).<br>
</li>
<li>Osserva l’IC al 95% che hai calcolato: <strong>contiene</strong> il valore 24?<br>
</li>
<li>Se l’IC <strong>contiene</strong> 24, puoi dire che il valore “24” è “molto probabile”? (No, attenzione! Vedi interpretazione corretta vs.&nbsp;errata.)<br>
</li>
<li>Se l’IC <strong>non</strong> contiene 24, puoi concludere che la media reale è “sicuramente” diversa da 24? (No, perché hai solo un campione piccolo e il concetto di <strong>significatività</strong> vs.&nbsp;<strong>copertura</strong> può essere fuorviante.)</li>
</ol>
<p><strong>Spunti di riflessione sui limiti</strong>:<br>
- Il <strong>“livello di fiducia”</strong> dell’IC non è una “probabilità” che <span class="math inline">\(\mu\)</span> sia all’interno di un singolo intervallo: è una <strong>proprietà della procedura</strong> sul lungo periodo.<br>
- Con <strong>pochi dati</strong>, le assunzioni (come la normalità) e la <strong>variabilità casuale</strong> giocano un ruolo enorme: l’intervallo può risultare poco stabile e molto sensibile a pochi valori estremi.<br>
- L’IC non dice “quanto è plausibile 24” (questo sarebbe più vicino a un approccio bayesiano, che definisce un <strong>intervallo di credibilità</strong>). L’IC frequentista dice soltanto che, ripetendo molte volte la stessa procedura, nel 95% dei casi il vero <span class="math inline">\(\mu\)</span> cadrà entro l’intervallo calcolato in ciascuna ripetizione.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-tip no-icon callout-titled" title="Soluzioni 3">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Soluzioni 3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Supponiamo siano stati raccolti i dati seguenti (sostituisci con i dati effettivi):</p>
<pre><code>28, 22, 26, 18, 30, 24, 27, 17, 21, 25</code></pre>
<p>Esercizio 1</p>
<ol type="1">
<li>Calcolo di media e deviazione standard campionaria</li>
</ol>
<p>Indichiamo i punteggi come <span class="math inline">\(X_1, X_2, \dots, X_{10}\)</span>. La <strong>media campionaria</strong> è:</p>
<p><span class="math display">\[
\bar{X} = \frac{1}{n}\sum_{i=1}^n X_i.
\]</span></p>
<p>Facendo la somma <span class="math inline">\(28 + 22 + 26 + 18 + 30 + 24 + 27 + 17 + 21 + 25 = 238\)</span>.<br>
Quindi, con <span class="math inline">\(n=10\)</span>, otteniamo:</p>
<p><span class="math display">\[
\bar{X} = \frac{238}{10} = 23.8.
\]</span></p>
<p>Per la <strong>deviazione standard campionaria</strong> <span class="math inline">\(s\)</span>, si utilizza:</p>
<p><span class="math display">\[
s = \sqrt{\frac{1}{n-1} \sum_{i=1}^n \bigl(X_i - \bar{X}\bigr)^2}.
\]</span></p>
<p>Calcolando (o usando un foglio di calcolo / software), si ricava approssimativamente:</p>
<p><span class="math display">\[
s \approx 4.26.
\]</span></p>
<ol start="2" type="1">
<li>Costruzione dell’Intervallo di Confidenza al 95%</li>
</ol>
<p>Poiché la <strong>varianza</strong> è sconosciuta e il <strong>campione</strong> è piccolo, usiamo la distribuzione <span class="math inline">\(t\)</span> di Student con <span class="math inline">\(n-1 = 9\)</span> gradi di libertà.<br>
- Livello di confidenza: <span class="math inline">\(95\%\)</span>.<br>
- <span class="math inline">\(\alpha = 0,05\)</span>, quindi <span class="math inline">\(\alpha/2 = 0,025\)</span>.<br>
- Il valore critico <span class="math inline">\(t_{\alpha/2,df=9}\)</span> è circa <strong>2,262</strong> (da tavole o software).</p>
<ol type="a">
<li>Errore standard</li>
</ol>
<p><span class="math display">\[
\text{SE} = \frac{s}{\sqrt{n}} = \frac{4.26}{\sqrt{10}} \approx 4.26 / 3.162 \approx 1.35.
\]</span></p>
<ol start="2" type="a">
<li>Margine di errore</li>
</ol>
<p><span class="math display">\[
E = t_{\alpha/2} \times \text{SE} \approx 2.262 \times 1.35 \approx 3.05.
\]</span></p>
<ol start="3" type="a">
<li>Intervallo di confidenza</li>
</ol>
<p><span class="math display">\[
\bar{X} \pm E \quad \Rightarrow \quad 23.8 \pm 3.05
\quad \Rightarrow \quad (20.75;\, 26.85).
\]</span></p>
<ol start="3" type="1">
<li>Interpretazione frequentista corretta</li>
</ol>
<ul>
<li>
<strong>Interpretazione corretta</strong>: se ripetessimo lo stesso tipo di studio molte volte (stessa procedura di campionamento, stesse dimensioni, stesso metodo di calcolo dell’IC), il <strong>95%</strong> di questi intervalli conterrà il vero valore della media della popolazione (<span class="math inline">\(\mu\)</span>).<br>
</li>
<li>
<strong>Interpretazione scorretta (da evitare)</strong>: “C’è il 95% di probabilità che la vera media sia qui dentro”. Nel frequentismo, <span class="math inline">\(\mu\)</span> è considerato un valore fisso e non aleatorio. L’incertezza riguarda l’intervallo, non il parametro.</li>
</ul>
<p><strong>Limite</strong>: con <strong>poche osservazioni</strong> (n=10), l’intervallo può risultare piuttosto ampio. Inoltre, l’assunzione di normalità della popolazione di partenza potrebbe non essere pienamente soddisfatta.</p>
<p>Esercizio 2</p>
<ol type="a">
<li>Calcolo di due nuovi IC: 80% e 99%</li>
</ol>
<p>Utilizziamo gli <strong>stessi</strong> <span class="math inline">\(\bar{X} = 23.8\)</span>, <span class="math inline">\(s = 4.26\)</span>, <span class="math inline">\(n=10\)</span>. Cambia solo il valore critico <span class="math inline">\(t\)</span>.</p>
<ol type="1">
<li>
<strong>IC all’80%</strong> (<span class="math inline">\(\alpha=0,20\)</span>, <span class="math inline">\(\alpha/2 = 0,10\)</span>):
<ul>
<li>
<span class="math inline">\(t_{0,10,df=9} \approx 1.383\)</span><br>
</li>
<li>
<span class="math inline">\(\text{SE} \approx 1.35\)</span> (come prima)<br>
</li>
<li>Margine di errore <span class="math inline">\(E = 1.383 \times 1.35 \approx 1.87\)</span><br>
</li>
<li>IC 80%: <span class="math inline">\((23.8 \pm 1.87)\)</span> <span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\((21.93;\, 25.67)\)</span>.</li>
</ul>
</li>
<li>
<strong>IC al 99%</strong> (<span class="math inline">\(\alpha=0,01\)</span>, <span class="math inline">\(\alpha/2 = 0,005\)</span>):
<ul>
<li>
<span class="math inline">\(t_{0,005,df=9} \approx 3.25\)</span><br>
</li>
<li>
<span class="math inline">\(\text{SE} \approx 1.35\)</span><br>
</li>
<li>Margine di errore <span class="math inline">\(E = 3.25 \times 1.35 \approx 4.39\)</span><br>
</li>
<li>IC 99%: <span class="math inline">\((23.8 \pm 4.39)\)</span> <span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\((19.41;\, 28.19)\)</span>.</li>
</ul>
</li>
</ol>
<ol start="2" type="a">
<li>Confronto delle ampiezze</li>
</ol>
<ul>
<li>
<strong>80%</strong>: <span class="math inline">\((21.93;\, 25.67)\)</span> (più stretto)<br>
</li>
<li>
<strong>95%</strong>: <span class="math inline">\((20.75;\, 26.85)\)</span> (intermedio)<br>
</li>
<li>
<strong>99%</strong>: <span class="math inline">\((19.41;\, 28.19)\)</span> (più largo)</li>
</ul>
<p>Aumentando il <strong>livello di confidenza</strong>, l’intervallo si <strong>espande</strong>. Per “coprire” il valore vero nel 99% delle volte, occorre un intervallo più ampio.</p>
<p>Esercizio 3</p>
<ol type="1">
<li>Calcolo in R</li>
</ol>
<p>Se in R inseriamo i dati:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">swls_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">28</span>, <span class="fl">22</span>, <span class="fl">26</span>, <span class="fl">18</span>, <span class="fl">30</span>, <span class="fl">24</span>, <span class="fl">27</span>, <span class="fl">17</span>, <span class="fl">21</span>, <span class="fl">25</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">swls_data</span><span class="op">)</span>  <span class="co"># ~ 23.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">swls_data</span><span class="op">)</span>    <span class="co"># ~ 4.26</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">swls_data</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>Confronto con il calcolo “a mano”</li>
</ol>
<p>La funzione <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> (di default) eseguirà un <strong>One Sample t-test</strong> con confidenza 95%. Restituisce:</p>
<ul>
<li>Un IC molto simile a <span class="math inline">\((20.75;\, 26.85)\)</span>, con possibili piccole differenze di arrotondamento.</li>
</ul>
<ol start="3" type="1">
<li>Ribadire l’interpretazione</li>
</ol>
<ul>
<li>Il risultato di <code><a href="https://rdrr.io/r/stats/t.test.html">t.test()</a></code> potrebbe riportare:<br><em>95 percent confidence interval: (20.72, 26.88)</em><br>
(o valori simili).<br>
</li>
<li>Anche qui vale la regola: <strong>non è una probabilità</strong> che <span class="math inline">\(\mu\)</span> sia dentro, bensì una <strong>proprietà della procedura</strong> (lungo periodo).</li>
</ul>
<p>Esercizio 4</p>
<ol type="1">
<li>
<strong>Ipotesi</strong>: “La media SWLS reale nella popolazione è 24”.<br>
</li>
<li>
<strong>Verifica se 24 è dentro l’IC al 95%</strong>. Dall’IC <span class="math inline">\((20.75;\, 26.85)\)</span>, notiamo che 24 <strong>rientra</strong> in questo intervallo.<br>
</li>
<li>Significa che è “probabile” 24?
<ul>
<li>Attenzione: l’<strong>IC frequentista</strong> non fornisce una probabilità su questo specifico valore. Dire che “24 è dentro l’intervallo” non equivale a dire “la probabilità che <span class="math inline">\(\mu\)</span> = 24 è 95%”.<br>
</li>
</ul>
</li>
<li>Se 24 fosse stato <strong>fuori</strong> dall’intervallo, non potremmo comunque affermare con certezza che <span class="math inline">\(\mu\neq 24\)</span>. Ricordiamo sempre che, con un campione così piccolo, l’<strong>incertezza</strong> è alta e l’IC si basa su <strong>assunzioni</strong> (normalità e stima corretta).</li>
</ol>
<p>Limiti dell’interpretazione</p>
<ul>
<li>Con campioni ridotti, <strong>basta poco</strong> (un outlier o una leggera deviazione dalla normalità) per alterare significativamente l’intervallo.<br>
</li>
<li>Il <strong>livello di confidenza</strong> (ad es. 95%) è una <strong>proprietà della procedura</strong>: in una serie di infiniti studi simili, il 95% di quegli intervalli conterrebbe <span class="math inline">\(\mu\)</span>. Non significa che, dato <strong>questo</strong> singolo intervallo, ci sia una “probabilità 95%” di includere il parametro.</li>
</ul>
<p><strong>Riepilogo Finale</strong></p>
<ol type="1">
<li>
<strong>Valori Numerici</strong>:
<ul>
<li>Media <span class="math inline">\(\bar{X} = 23.8\)</span>; dev. standard <span class="math inline">\(s \approx 4.26\)</span>.<br>
</li>
<li>IC 95% (a mano) <span class="math inline">\(\approx (20.75;\, 26.85)\)</span>.<br>
</li>
<li>IC 80% <span class="math inline">\(\approx (21.93;\, 25.67)\)</span>; IC 99% <span class="math inline">\(\approx (19.41;\, 28.19)\)</span>.<br>
</li>
</ul>
</li>
<li>
<strong>Interpretazione Frequentista</strong>:<br>
&gt; Nel lungo periodo, il 95% (o 99%, 80%, ecc.) degli intervalli calcolati con la stessa procedura conterrà il vero valore di <span class="math inline">\(\mu\)</span>.<br>
</li>
<li>
<strong>Limiti</strong> (campioni piccoli, ipotesi di normalità, differenza tra “copertura ripetuta” e “probabilità che <span class="math inline">\(\mu\)</span> sia in un singolo IC”).</li>
</ol>
<p>In questo modo, gli studenti vedono sia <strong>la parte di calcolo</strong> (formule, tabelle/valori critici, software) sia <strong>gli aspetti interpretativi</strong> (come evitare i fraintendimenti più comuni sul significato dell’IC frequentista).</p>
<p>Conclusioni generali</p>
<ol type="1">
<li>Con un <strong>campione così piccolo</strong> (n=10), l’intervallo di confidenza può essere <strong>largo</strong> e sensibile a <strong>qualsiasi deviazione</strong> dall’assunzione di normalità.<br>
</li>
<li>L’<strong>interpretazione frequentista</strong> si focalizza sulla “procedura” e sul “lungo periodo” (ripetizione dell’esperimento), non sulla probabilità che <span class="math inline">\(\mu\)</span> sia dentro questo intervallo specifico.<br>
</li>
<li>È facile <strong>incorrere in fraintendimenti</strong> (“c’è il 95% di probabilità che la vera media sia qui dentro?”), occorre ribadire che la <strong>probabilità</strong> secondo il frequentismo riguarda il <strong>campionamento e la costruzione</strong> dell’intervallo, non la posizione fissa del parametro.</li>
</ol>
</div>
</div>
</div>
</section><section id="informazioni-sullambiente-di-sviluppo" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="informazioni-sullambiente-di-sviluppo">Informazioni sull’Ambiente di Sviluppo</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">#&gt; Platform: aarch64-apple-darwin20</span></span>
<span><span class="co">#&gt; Running under: macOS Sequoia 15.6.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRblas.0.dylib </span></span>
<span><span class="co">#&gt; LAPACK: /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt; [1] C/UTF-8/C/C/C/C</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: Europe/Rome</span></span>
<span><span class="co">#&gt; tzcode source: internal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt;  [1] bayestestR_0.17.0     cmdstanr_0.9.0        pillar_1.11.0        </span></span>
<span><span class="co">#&gt;  [4] tinytable_0.13.0      patchwork_1.3.2       ggdist_3.3.3         </span></span>
<span><span class="co">#&gt;  [7] tidybayes_3.0.7       bayesplot_1.14.0      ggplot2_3.5.2        </span></span>
<span><span class="co">#&gt; [10] reliabilitydiag_0.2.1 priorsense_1.1.1      posterior_1.6.1      </span></span>
<span><span class="co">#&gt; [13] loo_2.8.0             rstan_2.32.7          StanHeaders_2.32.10  </span></span>
<span><span class="co">#&gt; [16] brms_2.22.0           Rcpp_1.1.0            sessioninfo_1.2.3    </span></span>
<span><span class="co">#&gt; [19] conflicted_1.2.0      janitor_2.2.1         matrixStats_1.5.0    </span></span>
<span><span class="co">#&gt; [22] modelr_0.1.11         tibble_3.3.0          dplyr_1.1.4          </span></span>
<span><span class="co">#&gt; [25] tidyr_1.3.1           rio_1.2.3             here_1.0.1           </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] gridExtra_2.3         inline_0.3.21         sandwich_3.1-1       </span></span>
<span><span class="co">#&gt;  [4] rlang_1.1.6           magrittr_2.0.3        multcomp_1.4-28      </span></span>
<span><span class="co">#&gt;  [7] snakecase_0.11.1      compiler_4.5.1        systemfonts_1.2.3    </span></span>
<span><span class="co">#&gt; [10] vctrs_0.6.5           stringr_1.5.1         pkgconfig_2.0.3      </span></span>
<span><span class="co">#&gt; [13] arrayhelpers_1.1-0    fastmap_1.2.0         backports_1.5.0      </span></span>
<span><span class="co">#&gt; [16] labeling_0.4.3        rmarkdown_2.29        ps_1.9.1             </span></span>
<span><span class="co">#&gt; [19] ragg_1.5.0            purrr_1.1.0           xfun_0.53            </span></span>
<span><span class="co">#&gt; [22] cachem_1.1.0          jsonlite_2.0.0        broom_1.0.9          </span></span>
<span><span class="co">#&gt; [25] parallel_4.5.1        R6_2.6.1              stringi_1.8.7        </span></span>
<span><span class="co">#&gt; [28] RColorBrewer_1.1-3    lubridate_1.9.4       estimability_1.5.1   </span></span>
<span><span class="co">#&gt; [31] knitr_1.50            zoo_1.8-14            pacman_0.5.1         </span></span>
<span><span class="co">#&gt; [34] Matrix_1.7-4          splines_4.5.1         timechange_0.3.0     </span></span>
<span><span class="co">#&gt; [37] tidyselect_1.2.1      abind_1.4-8           codetools_0.2-20     </span></span>
<span><span class="co">#&gt; [40] curl_7.0.0            processx_3.8.6        pkgbuild_1.4.8       </span></span>
<span><span class="co">#&gt; [43] lattice_0.22-7        withr_3.0.2           bridgesampling_1.1-2 </span></span>
<span><span class="co">#&gt; [46] coda_0.19-4.1         evaluate_1.0.5        survival_3.8-3       </span></span>
<span><span class="co">#&gt; [49] RcppParallel_5.1.11-1 tensorA_0.36.2.1      checkmate_2.3.3      </span></span>
<span><span class="co">#&gt; [52] stats4_4.5.1          insight_1.4.2         distributional_0.5.0 </span></span>
<span><span class="co">#&gt; [55] generics_0.1.4        rprojroot_2.1.1       rstantools_2.5.0     </span></span>
<span><span class="co">#&gt; [58] scales_1.4.0          xtable_1.8-4          glue_1.8.0           </span></span>
<span><span class="co">#&gt; [61] emmeans_1.11.2-8      tools_4.5.1           mvtnorm_1.3-3        </span></span>
<span><span class="co">#&gt; [64] grid_4.5.1            QuickJSR_1.8.0        colorspace_2.1-1     </span></span>
<span><span class="co">#&gt; [67] nlme_3.1-168          cli_3.6.5             textshaping_1.0.3    </span></span>
<span><span class="co">#&gt; [70] svUnit_1.0.8          Brobdingnag_1.2-9     V8_7.0.0             </span></span>
<span><span class="co">#&gt; [73] gtable_0.3.6          digest_0.6.37         TH.data_1.1-4        </span></span>
<span><span class="co">#&gt; [76] htmlwidgets_1.6.4     farver_2.1.2          memoise_2.0.1        </span></span>
<span><span class="co">#&gt; [79] htmltools_0.5.8.1     lifecycle_1.0.4       MASS_7.3-65</span></span></code><button title="Copia negli appunti" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bibliografia" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="bibliografia">Bibliografia</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-hoekstra2014robust" class="csl-entry" role="listitem">
Hoekstra, R., Morey, R. D., Rouder, J. N., &amp; Wagenmakers, E.-J. (2014). Robust misinterpretation of confidence intervals. <em>Psychonomic Bulletin &amp; Review</em>, <em>21</em>(5), 1157–1164.
</div>
<div id="ref-schervish2014probability" class="csl-entry" role="listitem">
Schervish, M. J., &amp; DeGroot, M. H. (2014). <em>Probability and statistics</em> (Vol. 563). Pearson Education London, UK:
</div>
</div>
</section></main><!-- /main --><script>
document.body.classList.add('classic-book');
document.addEventListener('DOMContentLoaded', function() {
  const paragraphs = document.querySelectorAll('p');
  paragraphs.forEach(p => {
    if (p.textContent.length > 200) {
      p.style.hyphens = 'auto';
      p.style.hyphenateCharacter = '-';
    }
  });
  const headings = document.querySelectorAll('h1, h2, h3, h4, h5, h6');
  headings.forEach(h => {
    h.style.fontFeatureSettings = '"liga" 1, "dlig" 1, "smcp" 1';
  });
});
</script><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiato!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiato!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ccaudek\.github\.io\/utet-frequentista\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
            // default icon
            link.classList.add("external");
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../../chapters/frequentist_inference/02_stime_parametri.html" class="pagination-link" aria-label="Stime, stimatori e parametri">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Stime, stimatori e parametri</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../chapters/frequentist_inference/04_sample_size.html" class="pagination-link" aria-label="La grandezza del campione">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">La grandezza del campione</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><strong>Inferenza frequentista in psicologia</strong> — Modulo del progetto UTET a supporto del manuale <em>Metodi bayesiani in psicologia</em>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ccaudek/utet-frequentista/blob/main/chapters/frequentist_inference/03_conf_interv.qmd" class="toc-action"><i class="bi bi-github"></i>Mostra il codice</a></li><li><a href="https://github.com/ccaudek/utet-frequentista/issues/new" class="toc-action"><i class="bi empty"></i>Segnala un problema</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Realizzato con <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>


<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>